# Maintainer: Kimiblock Moe

pkgname=firefox-developer-edition-portable
pkgver=146.0b9
pkgrel=1
epoch=1
pkgdesc="Firefox sandboxed by portable (en_US locale)"
arch=('x86_64')
url="https://github.com/Kraftland/portable"
license=('MPL-2.0')
groups=()
provides=(firefox-developer-edition)
options=(!debug !strip)
conflicts=("firefox-developer-edition")

optdepends=()

makedepends+=(firefox-developer-edition coreutils)

checkdepends=()

source=(
	portable-config
	firefox.desktop
)


md5sums=('SKIP'
         'SKIP')

function package() {
	depends=("portable")
	depends+=(alsa-lib  at-spi2-core  bash  cairo  dbus  ffmpeg4.4  fontconfig  freetype2  gcc-libs  gdk-pixbuf2  glib2  glibc  gtk3  hicolor-icon-theme  libpulse
                  libx11  libxcb  libxcomposite  libxdamage  libxext  libxfixes  libxrandr  libxss  libxt  mime-types  nspr  nss  pango  ttf-font)

	export pkgdir
	export pkgname
	export srcdir
	portable-packer \
		-v \
		--distro arch \
		--mode copy firefox-developer-edition \
		--hash true \
		--config "${srcdir}/portable-config" \
		--desktop-file "${srcdir}/firefox.desktop" \
		--dbus-activation

	echo '''[Desktop Entry]
Type=Application
Name=Firefox Developer Edition
GenericName=Stub for MPRIS
Icon=firefox-developer-edition
TryExec=portable
Exec=env _portableConfig="org.mozilla.firefox_developer_edition" portable -- %u
Terminal=false
NoDisplay=true''' >"${pkgdir}/usr/share/applications/firefox-developer-edition.desktop"
}