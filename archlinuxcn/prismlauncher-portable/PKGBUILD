# Maintainer: Kimiblock Moe

pkgname=prismlauncher-portable
pkgver=9.4
pkgrel=5
provides=(prismlauncher prismlauncher-portable prismlauncher-bwrap)
replaces=(prismlauncher-bwrap)
conflicts=(prismlauncher)
pkgdesc="Minecraft launcher with ability to manage multiple instances. Sandboxed by portable."
arch=(x86_64)
url='https://prismlauncher.org'
license=('GPL-3.0-only AND LGPL-3.0-or-later AND LGPL-2.0-or-later AND Apache-2.0 AND MIT AND LicenseRef-Batch AND OFL-1.1')
depends=(
glibc  gcc-libs  java-runtime  libgl  qt6-base  qt6-5compat  qt6-svg  qt6-imageformats  qt6-networkauth  quazip-qt6  zlib  hicolor-icon-theme tomlplusplus cmark portable)
makedepends=(desktop-file-utils)
optdepends=('visualvm: Profiling support')
source=(
	portable-config
	start.sh
	desktop.file
)
b2sums=(
	SKIP
	SKIP
	SKIP
)

package() {
	export pkgdir
	export pkgname
	export srcdir
	portable-packer \
		-v \
		--distro arch \
		--mode copy prismlauncher \
		--hash true \
		--config "${srcdir}/portable-config" \
		--desktop-file "${srcdir}/desktop.file"

	install -vDm755 "/usr/bin/prismlauncher" -t "${pkgdir}/usr/lib/portable/overlay-usr"
	ln -srf "${pkgdir}/usr/bin/prismlauncher-portable" "${pkgdir}/usr/bin/prismlauncher"
}
