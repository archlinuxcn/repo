
pkgname=drm_info
pkgver=2.9.0
pkgrel=1
license=(MIT)
pkgdesc='Small utility to dump info about DRM devices'
makedepends=(meson scdoc git)
depends=("libdrm>=2.4.115" libdisplay-info json-c pciutils)
arch=(x86_64)
url=https://gitlab.freedesktop.org/emersion/drm_info
conflicts=(drm_info)
source=("git+https://gitlab.freedesktop.org/emersion/drm_info.git")
sha512sums=('7070268e464a216d9c1043f65edd536520198370269ad3a36f9bea0c81f8c09096ed6b4ba222ad793a1816b3bf3f41423997f6ca995502b200b11a50e3594598')

build() {
	rm -rf build
	arch-meson build "${pkgname}-v${pkgver}" -Dlibpci=enabled -Dman-pages=enabled
	meson compile -C build
}

check () {
	meson test -C build
}

package() {
	meson install -C build --destdir="${pkgdir}"
	install -vDm644 "${pkgname}-v${pkgver}/LICENSE" \
		"${pkgdir}/usr/share/licenses/${pkgname}/LICENSE"
}
