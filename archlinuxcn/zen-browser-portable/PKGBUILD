# Maintainer: Kimiblock Moe
pkgname=zen-browser-portable
_firefox_version=146.0
pkgver=1.17.15b
_zen_version=${pkgver//_/-}
pkgrel=1
pkgdesc="Experience tranquillity while browsing the web without people tracking you, sandboxed by portable"
arch=('x86_64')
url="https://github.com/Kraftland/portable"
license=(MPL-2.0)
groups=()

depends=(
	ffmpeg
	onnxruntime
	libnotify
	portable
# Original
  alsa-lib
  at-spi2-core
  bash
  cairo
  dbus
  ffmpeg
  fontconfig
  freetype2
  gcc-libs
  gdk-pixbuf2
  glib2
  glibc
  gtk3
  hicolor-icon-theme
  libpulse
  libx11
  libxcb
  libxcomposite
  libxdamage
  libxext
  libxfixes
  libxrandr
  libxss
  libxt
  mime-types
  nspr
  nss
  pango
  ttf-font
)

options=(
	!emptydirs
	!lto
	!makeflags
	!debug
)

makedepends+=(portable zen-browser)

provides=("zen-browser=${pkgver}")
conflicts=(zen-browser)

checkdepends=()

source=(
	portable-config
	desktop.file
)

function package() {
	export pkgdir
	export pkgname
	export srcdir
	portable-packer \
		-v \
		--distro arch \
		--mode copy zen-browser \
		--hash true \
		--config "${srcdir}/portable-config" \
		--desktop-file "${srcdir}/desktop.file" \
		--dbus-activation

	echo '''[Desktop Entry]
Type=Application
Name=Zen Browser
GenericName=Stub for MPRIS
Icon=zen-browser
TryExec=portable
Exec=env _portableConfig=org.mozilla.zen portable -- %u
Terminal=false
NoDisplay=true''' >"${pkgdir}/usr/share/applications/zen-browser.desktop"

	echo '''[Desktop Entry]
Type=Application
Name=Zen Browser
GenericName=Stub for MPRIS
Icon=zen-browser
TryExec=portable
Exec=env _portableConfig=org.mozilla.zen portable -- %u
Terminal=false
NoDisplay=true''' >"${pkgdir}/usr/share/applications/zen-browser-portable.desktop"
}
sha256sums=('f8fb3d9a78b5020a3de8e991e00d3a86eabc301daa266a71dc4310ac2686123f'
            'b1366506d4df221581e67544edd00728b9793da1cb8609beec3cf138d4a75eaf')
