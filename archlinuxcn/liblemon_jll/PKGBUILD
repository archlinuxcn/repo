pkgname=liblemon_jll
pkgver=1.3.3+0
_src_commit=c2f1a05b88546ce88f5922cd8b45f67d2fd964c7
pkgrel=4
pkgdesc="CxxWrap.jl wrapper for lemon"
url="https://github.com/JuliaBinaryWrappers/LEMON_jll.jl.git"
arch=('aarch64' 'x86_64')
license=('MIT')
makedepends=(git cmake)
depends=(julia-git coin-or-lemon libcxxwrap_julia)
source=("https://raw.githubusercontent.com/JuliaPackaging/Yggdrasil/${_src_commit}/L/LEMON/bundled/cxxwrap/lemoncxxwrap.cpp")
sha256sums=('c5603bf05bd8968c1736b0e73003b8969306e4809fa1c3e6778e2dd075e02e94')
# LTO breaks unique linkage of guard variable
options=('!lto')

build() {
  g++ -shared -std=c++17 -O3 -fPIC ${CXXFLAGS} ${LDFLAGS} -o liblemoncxxwrap.so lemoncxxwrap.cpp -I/usr/include/julia -lemon -ljulia -lcxxwrap_julia
}

package() {
  install -D -m755 -t "$pkgdir/usr/lib" liblemoncxxwrap.so
}
